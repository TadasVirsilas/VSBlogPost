---
title: "Introducing R Tools for Visual Studio"
output: html_document
---

[R is a programming language](https://www.r-project.org/) that is widely used by
data scientists, and developers seeking a more powerful tool to work with data.
While data scientsts use R to write programs, their work product is rarely the
program itself. Instead, they produce reports or pressentations from the results
generated by their R program to help influence or drive businesss decisions.

R Tools for Visual Studio (RTVS), currently available as a Public Preview
release, is a new tool from Microsoft for creating R programs using Visual
Studio. It can be [downloaded by following the instructions
here](https://microsoft.github.io/RTVS-docs/installation.html), and you can
[read our documentation here](https://microsoft.github.io/RTVS-docs/). 

I've created a video that walks you through the major features of the product:

<iframe width="560" height="315" src="https://www.youtube.com/embed/KPS0ytrt9SA" frameborder="0" allowfullscreen></iframe>

## A Quick Tour of R

R is a strong dynamically typed interpreted language that draws a lot of
inspiration from other languages. It is a functional language that heavily draws
from [Scheme](https://en.wikipedia.org/wiki/Scheme_(programming_language)) and
[S](https://en.wikipedia.org/wiki/S_(programming_language)). It is beyond the
scope of this blog post to discuss the semantics of the language, but I strongly
encourage you to read these two freely available online books for a deep
introduction to the language:

1. [Advanced R](http://adv-r.had.co.nz/)
1. [The R Inferno]()

The remainder of this blog post is a quick tour of R, its libraries, and RTVS
with the goal of inspiring you to learn more about the language, its libraries,
and how it can be a useful tool in your toolbox for analyzing data. 

The quickest way to get started with R is through its [Read-Eval-Print Loop
(REPL)](https://en.wikipedia.org/wiki/Read%E2%80%93eval%E2%80%93print_loop),
which lets you send commands *interactively* to the R interpreter. In RTVS, we
surface the R REPL through the R Interactive Window.

As you can see, you can type 3 + 4 and have the result immediately computed by
R; no compilation step necessary:

```{r}
3 + 4
```

R's strength is working with data. Therefore, it's not surprising that the most
heavily used data structure in R is the [R
dataframe](http://www.r-tutor.com/r-introduction/data-frame).  There are many
ways of getting data into an R dataframe, but perhaps the easiest is to get it
via a URI. Below, we're reading a CSV file from Github: TODO: make sure to
chnage URI once I upload the file

```{r}
usa_airports <- read.csv("usa_airports.dat", stringsAsFactors = TRUE)
```

In R, you assign variables using the `<-` operator, and you invoke functions
using parenthesis. So in the code above, we're invoking the `read.csv()` R
library function, passing in the URI to the CSV file. 

```{r}
?read.csv
```

You can get help on any R library function by using the `?` operator from the REPL.

Next, we're using another R function, `head()` to display a summary of the first
5 lines of the file. 

```{r}
head(usa_airports)
```

The `head` function is fairly primitive, as it just generates text-based output.
That's not surprising since [R has been around since
1993](https://en.wikipedia.org/wiki/R_(programming_language)). Surely we can do
better in 2016? 

As it turns out, we can. There are a lot of libraries in R that bind the R
programming language to the most powerful hardware-accelerated rendering
platform on the planet: HTML. In R, this is accomplished through a set of Open
Source libraries known as [htmlwidgets for R](http://www.htmlwidgets.org/).
Below is the same dataframe rendered using the DataTable widget. We generate an
HTML page that contains all of the data from the usa_airports dataframe, and
open up a browser window using the default browser that shows an interactive
table containing the data. The data really is interactive; try typing "Seattle"
into the search box to see it filter the data to only airports in Seattle in
real time, or click on column headings to sort by that column.

```{r}
library(DT)
datatable(usa_airports[,c("name", "city", "country", "IATA_FAA", "lat", "lon", "altitude")])
```

If you prefer to manipulate your data programmatically, you can easily do so as
well. A really popular library for manipulating data is the [dplyr library by
Hadley
Wickham](https://cran.rstudio.com/web/packages/dplyr/vignettes/introduction.html).
Let's say that we wanted to generate a list of airports located near New York
city. We can do this easily via the `subset` function from `dplyr`.

```{r}
library(dplyr)
new_york_airports <- subset(usa_airports, city == "New York")
datatable(new_york_airports)
```

If we wanted to do more sophisticated filtering, say all the airports in NYC at
below 25 feet elevation, ordering the rows by altitude and selecting only the
name, altitude, lattitude and longitude of the airport:

```{r}
low_nyc <- usa_airports %>% 
	filter(city == "New York" & altitude < 25) %>% 
	arrange(altitude) %>% 
	select(name, altitude, lat, lon)
```

Here, we see a more sophisticated use of R syntax via the `%>%` or "pipe"
operator. 

If you're curious about the implementation of the pipe operator, see the
[magrittr](https://github.com/smbache/magrittr) package, as well as this
excellent blog post on how [magrittr was influenced by the forward pipe operator
from
F#](http://www.r-statistics.com/2014/08/simpler-r-coding-with-pipes-the-present-and-future-of-the-magrittr-package/).  

## Plotting data on maps

Once we have our dataset, we can go plot it on an interactive map. The [leaflet
HtmlWidget](http://www.htmlwidgets.org/showcase_leaflet.html) is an excellent
library for generating interactive maps. In the code fragment below, we take the
dataframe that we generated via `dplyr` in the previous step, and using the
now-familiar pipe operator send it to the `leaflet library`, asking it to
generate map tiles and plotting circles on them using the `lon` and `lat`
columns for the positions of the circles, and using the `name` column for the
popup that appears when the user clicks on a circle.

```{r}
library(leaflet)
low_nyc %>% 
	leaflet() %>% 
	addTiles() %>% 
	addCircles(~lon, ~lat, popup = ~name) %>% 
	print
```



## Building an interactive application with Shiny



# One more thing ...

We've talked about a bunch of things in this brief blog post. However, perhaps
the coolest thing about this blog post is ... _I wrote it in Visual Studio_. If
you want to look at the source code for it, you can [get it at my
Github](https://github.com/jflam/VSBlogPost).

![](./vs_blog_post.png)
